# HNSW vs IVF-PQ Deep Dive

> ë²¡í„° ê²€ìƒ‰ì—ì„œ ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë‘ ê°€ì§€ ANN(Approximate Nearest Neighbor) ì¸ë±ìŠ¤ ì•Œê³ ë¦¬ì¦˜ì˜ ì‹¬ì¸µ ë¹„êµ ë¶„ì„.

---

## ëª©ì°¨

1. [ë¬´ì—‡ì¸ê°€?](#1-ë¬´ì—‡ì¸ê°€)
2. [ê°œë…](#2-ê°œë…)
3. [ì•„í‚¤í…ì²˜ì™€ ë™ì‘ ì›ë¦¬](#3-ì•„í‚¤í…ì²˜ì™€-ë™ì‘-ì›ë¦¬)
4. [ìœ ì¦ˆ ì¼€ì´ìŠ¤ ë° ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤](#4-ìœ ì¦ˆ-ì¼€ì´ìŠ¤-ë°-ë² ìŠ¤íŠ¸-í”„ë™í‹°ìŠ¤)
5. [ì¥/ë‹¨ì ](#5-ì¥ë‹¨ì )
6. [ì°¨ì´ì  ë¹„êµ](#6-ì°¨ì´ì -ë¹„êµ)
7. [ì‚¬ìš© ì‹œ ì£¼ì˜ì ](#7-ì‚¬ìš©-ì‹œ-ì£¼ì˜ì )
8. [ê¸°íƒ€ ê°œë°œìë¡œì„œ ì•Œì•„ë‘¬ì•¼ í•  ê²ƒë“¤](#8-ê¸°íƒ€-ê°œë°œìë¡œì„œ-ì•Œì•„ë‘¬ì•¼-í• -ê²ƒë“¤)
9. [Sources](#9-sources)

---

## Executive Summary

HNSW(Hierarchical Navigable Small World)ì™€ IVF-PQ(Inverted File with Product Quantization)ëŠ” ë²¡í„° ê²€ìƒ‰ì—ì„œ ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë‘ ê°€ì§€ ANN ì¸ë±ìŠ¤ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. **HNSWëŠ” ë†’ì€ recallê³¼ ë¹ ë¥¸ ê²€ìƒ‰**ì„, **IVF-PQëŠ” ê·¹ë‹¨ì  ë©”ëª¨ë¦¬ ì ˆê°ê³¼ billion-scale ì²˜ë¦¬**ë¥¼ ì œê³µí•œë‹¤. `HNSW â†’ IVF-PQ ì¸ë±ìŠ¤ ì „í™˜`ì€ **Scale Up ì „ëµ**ìœ¼ë¡œ, ë™ì¼ í•˜ë“œì›¨ì–´ì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ì ˆê°í•˜ê³  ê²€ìƒ‰ ë²”ìœ„ë¥¼ ì¶•ì†Œí•˜ì—¬ ë‹¨ì¼ ë…¸ë“œ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•˜ëŠ” ìµœì í™”ë¥¼ ì˜ë¯¸í•œë‹¤.

---

## 1. ë¬´ì—‡ì¸ê°€?

### HNSW (Hierarchical Navigable Small World)

**ê·¸ë˜í”„ ê¸°ë°˜** ANN ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜. ë²¡í„°ë“¤ì„ ë‹¤ì¸µ ê·¸ë˜í”„ë¡œ ì—°ê²°í•˜ì—¬ ë¡œê·¸ ì‹œê°„ ë³µì¡ë„ë¡œ ìœ ì‚¬ ë²¡í„°ë¥¼ íƒìƒ‰í•œë‹¤.

- ğŸ“„ ì›ë…¼ë¬¸: Malkov & Yashunin, 2016 ([arXiv:1603.09320](https://arxiv.org/abs/1603.09320))
- ğŸ—ï¸ êµ¬í˜„ì²´: FAISS, Milvus, Qdrant, Weaviate, pgvector ë“± ê±°ì˜ ëª¨ë“  ë²¡í„° DB

### IVF-PQ (Inverted File + Product Quantization)

**í´ëŸ¬ìŠ¤í„°ë§ + ì••ì¶•** ê¸°ë°˜ ANN ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜. ë²¡í„°ë¥¼ í´ëŸ¬ìŠ¤í„°ë¡œ ë‚˜ëˆ„ê³ (IVF), ê° ë²¡í„°ë¥¼ ì†ì‹¤ ì••ì¶•(PQ)í•˜ì—¬ ë©”ëª¨ë¦¬ì™€ ê²€ìƒ‰ ë²”ìœ„ë¥¼ ë™ì‹œì— ì¤„ì¸ë‹¤.

- ğŸ“„ ì›ë…¼ë¬¸: JÃ©gou, Douze & Schmid, 2011 (IEEE TPAMI)
- ğŸ—ï¸ êµ¬í˜„ì²´: FAISS, Milvus, NVIDIA cuVS, LanceDB ë“±

> **í™•ì‹ ë„**: `[Confirmed]` â€” ì›ë…¼ë¬¸, ê³µì‹ ë¬¸ì„œ, ë‹¤ìˆ˜ ë…ë¦½ ì¶œì²˜ì—ì„œ ê²€ì¦

---

## 2. ê°œë…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ANN (Approximate NN) ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸŒ³ íŠ¸ë¦¬ ê¸°ë°˜          ğŸ”— ê·¸ë˜í”„ ê¸°ë°˜        ğŸ“¦ ì–‘ìí™” ê¸°ë°˜    â”‚
â”‚  â”œâ”€ KD-Tree           â”œâ”€ NSW               â”œâ”€ SQ (Scalar)   â”‚
â”‚  â””â”€ Annoy             â”œâ”€ HNSW  â—€â”€â”€ ì—¬ê¸°!   â”œâ”€ PQ (Product)  â”‚
â”‚                       â””â”€ DiskANN           â””â”€ OPQ           â”‚
â”‚                                                              â”‚
â”‚  ğŸ“‚ í•´ì‹± ê¸°ë°˜          ğŸ—‚ï¸ í´ëŸ¬ìŠ¤í„° ê¸°ë°˜                       â”‚
â”‚  â””â”€ LSH               â”œâ”€ IVF-Flat                           â”‚
â”‚                        â”œâ”€ IVF-PQ  â—€â”€â”€ ì—¬ê¸°!                  â”‚
â”‚                        â””â”€ IVF-SQ                             â”‚
â”‚                                                              â”‚
â”‚  ğŸ”€ í•˜ì´ë¸Œë¦¬ë“œ                                               â”‚
â”‚  â”œâ”€ HNSW + PQ                                               â”‚
â”‚  â”œâ”€ IVF + HNSW (coarse quantizer)                           â”‚
â”‚  â””â”€ ScaNN (Google)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### HNSW í•µì‹¬ ê°œë…

**Skip List** + **Navigable Small World ê·¸ë˜í”„**ì˜ ê²°í•©:

- **Skip List**: ë‹¤ì¸µ ì—°ê²° ë¦¬ìŠ¤íŠ¸. ìƒìœ„ ë ˆì´ì–´ëŠ” "ê³ ì†ë„ë¡œ", í•˜ìœ„ ë ˆì´ì–´ëŠ” "ì§€ë°©ë„ë¡œ"
- **NSW ê·¸ë˜í”„**: ì¥ê±°ë¦¬ + ë‹¨ê±°ë¦¬ ë§í¬ë¥¼ ëª¨ë‘ ê°€ì§„ ê·¼ì ‘ ê·¸ë˜í”„ â†’ `(poly/)logarithmic` íƒìƒ‰ ë³µì¡ë„
- ì´ ë‘ ê°œë…ì„ ê²°í•©í•´ **ê³„ì¸µì  ê·¼ì ‘ ê·¸ë˜í”„**ë¥¼ êµ¬ì„±

### IVF-PQ í•µì‹¬ ê°œë…

**íŒŒí‹°ì…”ë‹**(IVF) + **ì†ì‹¤ ì••ì¶•**(PQ)ì˜ ê²°í•©:

- **IVF (Inverted File)**: k-means í´ëŸ¬ìŠ¤í„°ë§ìœ¼ë¡œ ë²¡í„° ê³µê°„ì„ íŒŒí‹°ì…˜ â†’ ê²€ìƒ‰ ì‹œ ì¼ë¶€ íŒŒí‹°ì…˜ë§Œ íƒìƒ‰
- **PQ (Product Quantization)**: ê³ ì°¨ì› ë²¡í„°ë¥¼ ì„œë¸Œë²¡í„°ë¡œ ë¶„í•  â†’ ê° ì„œë¸Œë²¡í„°ë¥¼ ì½”ë“œë¶ì˜ ì¸ë±ìŠ¤ë¡œ ëŒ€ì²´í•˜ì—¬ ì••ì¶•

> **í™•ì‹ ë„**: `[Confirmed]` â€” ì›ë…¼ë¬¸ ë° ë‹¤ìˆ˜ ê³µì‹ ë¬¸ì„œ ì¼ì¹˜

---

## 3. ì•„í‚¤í…ì²˜ì™€ ë™ì‘ ì›ë¦¬

### ğŸ”— HNSW ì•„í‚¤í…ì²˜

```
Layer 3 (ìµœìƒìœ„)    â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—      â† ë…¸ë“œ ìˆ˜ ì ìŒ, ì¥ê±°ë¦¬ ë§í¬
                    â”‚                         â”‚
Layer 2             â—â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—      â† ì¤‘ê°„ ë°€ë„
                    â”‚    â”‚          â”‚         â”‚
Layer 1             â—â”€â”€â—â”€â—â”€â”€â—â”€â”€â”€â—â”€â”€â—â”€â”€â—â”€â”€â—â”€â”€â”€â—      â† ë” ë°€ì§‘
                    â”‚  â”‚ â”‚  â”‚   â”‚  â”‚  â”‚  â”‚   â”‚
Layer 0 (ìµœí•˜ìœ„)    â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—      â† ëª¨ë“  ë…¸ë“œ í¬í•¨, ë‹¨ê±°ë¦¬ ë§í¬

                    â”€â”€â”€â”€â”€â”€â”€ ê²€ìƒ‰ ë°©í–¥ â”€â”€â”€â”€â”€â”€â”€â–¶
                    (ìƒìœ„â†’í•˜ìœ„, Greedy Search)
```

**ê²€ìƒ‰ ê³¼ì •**:
```
1. Entry Point (Layer 3)
   â”‚
   â–¼  Greedy traversal â†’ í˜„ì¬ ë ˆì´ì–´ì—ì„œ ë” ê°€ê¹Œìš´ ì´ì›ƒì´ ì—†ì„ ë•Œê¹Œì§€
2. Layer 2ë¡œ í•˜ê°•
   â”‚
   â–¼  ê°™ì€ greedy traversal ë°˜ë³µ
3. Layer 1ë¡œ í•˜ê°•
   â”‚
   â–¼
4. Layer 0ì—ì„œ ìµœì¢… k-NN ê²°ê³¼ ë°˜í™˜
```

**ì‚½ì… ê³¼ì •**:
```
ìƒˆ ë²¡í„° v ì‚½ì…:
  1. ì‚½ì… ë ˆì´ì–´ l = floor(-ln(rand()) Ã— m_L)   (m_L â‰ˆ 1/ln(M))
  2. ìµœìƒìœ„ ë ˆì´ì–´ë¶€í„° ë ˆì´ì–´ lê¹Œì§€ greedy íƒìƒ‰ìœ¼ë¡œ ì§„ì…ì  ì°¾ê¸°
  3. ë ˆì´ì–´ l ~ 0 ì—ì„œ: efConstructionê°œ í›„ë³´ ì¤‘ Mê°œ ì´ì›ƒê³¼ ì–‘ë°©í–¥ ì—°ê²°
```

**í•µì‹¬ íŒŒë¼ë¯¸í„°**:

| íŒŒë¼ë¯¸í„° | ì˜ë¯¸ | ê¸°ë³¸ê°’ | ì˜í–¥ |
|----------|------|--------|------|
| `M` | ë…¸ë“œë‹¹ ìµœëŒ€ ì—°ê²° ìˆ˜ | 16 | â†‘ recall, â†‘ ë©”ëª¨ë¦¬ |
| `efConstruction` | ë¹Œë“œ ì‹œ í›„ë³´ íƒìƒ‰ ìˆ˜ | 200 | â†‘ ë¹Œë“œ í’ˆì§ˆ, â†‘ ë¹Œë“œ ì‹œê°„ |
| `efSearch` | ê²€ìƒ‰ ì‹œ í›„ë³´ íƒìƒ‰ ìˆ˜ | 50~200 | â†‘ recall, â†‘ ê²€ìƒ‰ ì§€ì—° |

**ë©”ëª¨ë¦¬**: ~1.3â€“2Ã— raw vector data. 1Mê°œ ë²¡í„°(384-d, float32) â‰ˆ **1.5GB+** (M=16 ê¸°ì¤€)

### ğŸ“¦ IVF-PQ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì¸ë±ì‹± (Offline) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  Step 1: IVF (íŒŒí‹°ì…”ë‹)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  k-means í´ëŸ¬ìŠ¤í„°ë§ â†’ nlistê°œ í´ëŸ¬ìŠ¤í„° (Voronoi cells)   â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€C1â”€â”€â”  â”Œâ”€â”€C2â”€â”€â”  â”Œâ”€â”€C3â”€â”€â”    â† í´ëŸ¬ìŠ¤í„° centroid  â”‚   â”‚
â”‚  â”‚    â”‚ â€¢â€¢â€¢â€¢ â”‚  â”‚ â€¢â€¢â€¢  â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢ â”‚    â† ì†Œì† ë²¡í„°ë“¤        â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  Step 2: PQ (ì••ì¶•)                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ì›ë³¸ ë²¡í„° (768-d):                                      â”‚   â”‚
â”‚  â”‚  [0.12, 0.45, ..., 0.89]                                â”‚   â”‚
â”‚  â”‚         â”‚                                                â”‚   â”‚
â”‚  â”‚         â–¼  ì”ì°¨ = ë²¡í„° - centroid                        â”‚   â”‚
â”‚  â”‚  [0.02, -0.05, ..., 0.09]                               â”‚   â”‚
â”‚  â”‚         â”‚                                                â”‚   â”‚
â”‚  â”‚         â–¼  mê°œ ì„œë¸Œë²¡í„°ë¡œ ë¶„í•  (ì˜ˆ: m=8)                  â”‚   â”‚
â”‚  â”‚  [sub1][sub2][sub3][sub4][sub5][sub6][sub7][sub8]       â”‚   â”‚
â”‚  â”‚    â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚          â”‚   â”‚
â”‚  â”‚    â–¼     â–¼     â–¼     â–¼     â–¼     â–¼     â–¼     â–¼          â”‚   â”‚
â”‚  â”‚   id3   id7   id1   id5   id2   id8   id4   id6         â”‚   â”‚
â”‚  â”‚   (ê° ì„œë¸Œë²¡í„° â†’ ì½”ë“œë¶ centroid IDë¡œ ì¹˜í™˜)              â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  ìµœì¢… PQ ì½”ë“œ: [3, 7, 1, 5, 2, 8, 4, 6]  â† 8 bytes!    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê²€ìƒ‰ (Online) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  1. Query â†’ nprobeê°œ ê°€ì¥ ê°€ê¹Œìš´ í´ëŸ¬ìŠ¤í„° ì„ íƒ                  â”‚
â”‚  2. ì„ íƒëœ í´ëŸ¬ìŠ¤í„° ë‚´ PQ ì½”ë“œë“¤ê³¼ ê±°ë¦¬ ê³„ì‚° (LUT ê¸°ë°˜)         â”‚
â”‚  3. Top-k ê²°ê³¼ ë°˜í™˜                                             â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Query â”€â”€â–¶ [C2, C5, C1]  (nprobe=3)    â”‚                    â”‚
â”‚  â”‚              â”‚                          â”‚                    â”‚
â”‚  â”‚              â–¼                          â”‚                    â”‚
â”‚  â”‚  LUT (Look-Up Table) êµ¬ì„±:             â”‚                    â”‚
â”‚  â”‚  queryì˜ ê° ì„œë¸Œë²¡í„° â†” ì½”ë“œë¶ ê±°ë¦¬     â”‚                    â”‚
â”‚  â”‚              â”‚                          â”‚                    â”‚
â”‚  â”‚              â–¼                          â”‚                    â”‚
â”‚  â”‚  PQ ì½”ë“œ [3,7,1,5,2,8,4,6]            â”‚                    â”‚
â”‚  â”‚  ê±°ë¦¬ = LUT[0][3] + LUT[1][7] + ...    â”‚                    â”‚
â”‚  â”‚        = sum of 8 lookups (ì´ˆê³ ì†!)     â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ íŒŒë¼ë¯¸í„°**:

| íŒŒë¼ë¯¸í„° | ì˜ë¯¸ | ê¸°ë³¸ê°’ | ì˜í–¥ |
|----------|------|--------|------|
| `nlist` | í´ëŸ¬ìŠ¤í„° ìˆ˜ | âˆšN ~ 4âˆšN | â†‘ ì„¸ë¶„í™”, â†‘ í•™ìŠµ ì‹œê°„ |
| `m` (pq_dim) | ì„œë¸Œë²¡í„° ìˆ˜ | 8~64 | â†‘ ì •ë°€ë„, â†‘ ë©”ëª¨ë¦¬ |
| `nbits` (pq_bits) | ì½”ë“œë¶ ë¹„íŠ¸ ìˆ˜ | 8 | â†‘ ì½”ë“œë¶ í¬ê¸°, â†‘ ì •ë°€ë„ |
| `nprobe` | íƒìƒ‰ í´ëŸ¬ìŠ¤í„° ìˆ˜ | nlistì˜ 5~10% | â†‘ recall, â†‘ ê²€ìƒ‰ ì§€ì—° |

**ë©”ëª¨ë¦¬**: 768-d float32 ë²¡í„° ê¸°ì¤€
- ì›ë³¸: 768 Ã— 4 = **3,072 bytes/vector**
- PQ (m=8, 8bit): **8 bytes/vector** â†’ ğŸ”¥ **~99.7% ì••ì¶•**

> **í™•ì‹ ë„**: `[Confirmed]` â€” NVIDIA, FAISS, Milvus ê³µì‹ ë¬¸ì„œ, Pinecone êµìœ¡ ìë£Œ ì¼ì¹˜

---

## 4. ìœ ì¦ˆ ì¼€ì´ìŠ¤ ë° ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### ğŸ¯ HNSW ì í•© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | ì´ìœ  |
|----------|------|
| ğŸ” RAG / Semantic Search | ë†’ì€ recallì´ ë‹µë³€ í’ˆì§ˆì— ì§ê²° |
| ğŸ’¬ ì‹¤ì‹œê°„ ì±—ë´‡ ì‘ë‹µ | ë‚®ì€ ì§€ì—° ì‹œê°„ |
| ğŸ“ ë¬¸ì„œ ê¸°ë°˜ Q&A | ì •í™•ë„ ìš°ì„  |
| ğŸ”„ ë™ì  ë°ì´í„° (CRUD ë¹ˆë²ˆ) | í•™ìŠµ ë¶ˆí•„ìš”, ì ì§„ì  ì—…ë°ì´íŠ¸ ê°€ëŠ¥ |
| ğŸ“Š ìˆ˜ë°±ë§Œ~ìˆ˜ì–µ ë²¡í„° | ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í•œ í™˜ê²½ |

### ğŸ¯ IVF-PQ ì í•© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | ì´ìœ  |
|----------|------|
| ğŸ–¼ï¸ ëŒ€ê·œëª¨ ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ìœ ì‚¬ë„ ê²€ìƒ‰ | billion-scale ë°ì´í„° ì²˜ë¦¬ |
| ğŸ“± ì—£ì§€ ë””ë°”ì´ìŠ¤ / ë©”ëª¨ë¦¬ ì œí•œ í™˜ê²½ | ê·¹ë‹¨ì  ë©”ëª¨ë¦¬ ì ˆê° |
| ğŸ­ ë°°ì¹˜ ì²˜ë¦¬ (throughput ìš°ì„ ) | ë†’ì€ ì²˜ë¦¬ëŸ‰ |
| ğŸ“ ì •ì  ë°ì´í„°ì…‹ | ì¸ë±ìŠ¤ ì¬ë¹Œë“œ ë¶€ë‹´ ì ìŒ |
| ğŸŒ Facebook ì´ë¯¸ì§€ ê²€ìƒ‰, YouTube ìœ ì‚¬ ì˜ìƒ | ì‹¤ì œ í”„ë¡œë•ì…˜ ì‚¬ë¡€ |

### âœ… ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ† Production Best Practices              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. ğŸ¯ Recall íƒ€ê²Ÿ: 90-95%ê°€ sweet spot                     â”‚
â”‚     â†’ 95% â†’ 99% ì˜¬ë¦¬ë©´ ê²€ìƒ‰ ì‹œê°„ 3ë°°, í’ˆì§ˆ ì°¨ì´ëŠ” ë¯¸ë¯¸      â”‚
â”‚                                                              â”‚
â”‚  2. ğŸ“ ë°˜ë“œì‹œ ë²¤ì¹˜ë§ˆí¬                                       â”‚
â”‚     â†’ Ground truth set êµ¬ì¶• â†’ Recall@k, MRR, NDCG ì¸¡ì •      â”‚
â”‚     â†’ "vibes"ì— ì˜ì¡´í•˜ì§€ ë§ ê²ƒ!                              â”‚
â”‚                                                              â”‚
â”‚  3. ğŸ”€ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ í™œìš©                                   â”‚
â”‚     â†’ BM25 (keyword) + Vector ê²€ìƒ‰ ê²°í•©ìœ¼ë¡œ ì •ë°€ë„ í–¥ìƒ      â”‚
â”‚                                                              â”‚
â”‚  4. ğŸ”§ íŒŒë¼ë¯¸í„° íŠœë‹ ìˆœì„œ                                     â”‚
â”‚     HNSW:  M(16â†’32) â†’ efSearch(50â†’200) â†’ efConstruction     â”‚
â”‚     IVF-PQ: nlist(âˆšN) â†’ nprobe(5-10%) â†’ m(8â†’16) â†’ nbits    â”‚
â”‚                                                              â”‚
â”‚  5. ğŸ“Š ëª¨ë‹ˆí„°ë§ í•„ìˆ˜ í•­ëª©                                     â”‚
â”‚     â†’ ê²€ìƒ‰ ì§€ì—°(p50/p99), recall, ì¸ë±ìŠ¤ í¬ê¸°, ì ì¬ìœ¨       â”‚
â”‚                                                              â”‚
â”‚  6. ğŸ”„ ì¬ì¸ë±ì‹± ê³„íš                                         â”‚
â”‚     â†’ ì„ë² ë”© ëª¨ë¸ êµì²´ ì‹œ ì „ì²´ ì¬ì¸ë±ì‹± í•„ìš”                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **í™•ì‹ ë„**: `[Likely]` â€” ë‹¤ìˆ˜ ì‹¤ë¬´ ê²½í—˜ ê¸°ë°˜ ê°€ì´ë“œ, í™˜ê²½ë³„ ì°¨ì´ ìˆì„ ìˆ˜ ìˆìŒ

---

## 5. ì¥/ë‹¨ì 

### HNSW

| | ë‚´ìš© |
|---|---|
| âœ… **ì¥ì ** | ğŸ… ìµœê³  ìˆ˜ì¤€ì˜ recall (state-of-the-art) |
| | âš¡ ë¹ ë¥¸ ê²€ìƒ‰ ì†ë„ (ë¡œê·¸ ì‹œê°„ ë³µì¡ë„) |
| | ğŸ”„ í•™ìŠµ ë¶ˆí•„ìš”, ì ì§„ì  ì‚½ì…/ì—…ë°ì´íŠ¸ ê°€ëŠ¥ |
| | ğŸ›ï¸ efSearchë¡œ recall â†” ì†ë„ ì‹¤ì‹œê°„ íŠœë‹ |
| | ğŸ“ˆ ë°ì´í„°ì…‹ í¬ê¸°ì— ë¡œê·¸ ë¹„ë¡€í•˜ì—¬ ê²€ìƒ‰ ì‹œê°„ ì¦ê°€ |
| âŒ **ë‹¨ì ** | ğŸ’¾ ë†’ì€ ë©”ëª¨ë¦¬ ì‚¬ìš© (raw dataì˜ 1.3~2ë°°) |
| | ğŸ¢ ì¸ë±ìŠ¤ ë¹Œë“œ ì‹œê°„ ëŠë¦¼ (ê·¸ë˜í”„ êµ¬ì¶•) |
| | ğŸš« billion-scaleì—ì„œëŠ” ë‹¨ë… ì‚¬ìš© ì–´ë ¤ì›€ |
| | ğŸ”§ M ê°’ì— ë”°ë¥¸ ë©”ëª¨ë¦¬ ê¸‰ì¦ (M=512 â†’ 1M ë²¡í„°ì— ~5GB) |

### IVF-PQ

| | ë‚´ìš© |
|---|---|
| âœ… **ì¥ì ** | ğŸ’¾ ê·¹ë‹¨ì  ë©”ëª¨ë¦¬ ì ˆê° (~97-99%) |
| | ğŸŒ billion-scale ë°ì´í„° ë‹¨ì¼ ë¨¸ì‹ ì—ì„œ ì²˜ë¦¬ ê°€ëŠ¥ |
| | âš¡ í´ëŸ¬ìŠ¤í„° pruningìœ¼ë¡œ ê²€ìƒ‰ ë²”ìœ„ ëŒ€í­ ì¶•ì†Œ |
| | ğŸ–¥ï¸ GPU ê°€ì† ìµœì í™” (NVIDIA cuVS) |
| | ğŸ“¦ LUT ê¸°ë°˜ ê±°ë¦¬ ê³„ì‚°ìœ¼ë¡œ ìºì‹œ íš¨ìœ¨ì  |
| âŒ **ë‹¨ì ** | ğŸ“‰ lossy ì••ì¶•ìœ¼ë¡œ recall ê°ì†Œ |
| | ğŸ“ í•™ìŠµ ë‹¨ê³„ í•„ìš” (k-means + ì½”ë“œë¶ í›ˆë ¨) |
| | ğŸ”§ ì •ì  ë°ì´í„°ì— ìµœì í™”, ë™ì  ì—…ë°ì´íŠ¸ ì‹œ ì¬í•™ìŠµ í•„ìš” |
| | ğŸ“ íŒŒë¼ë¯¸í„° íŠœë‹ì´ ë³µì¡ (nlist, m, nprobe, nbits) |
| | ğŸ¢ ì¸ë±ìŠ¤ ë¹Œë“œ ì‹œê°„ IVF-Flat ëŒ€ë¹„ 2~5ë°° |

> **í™•ì‹ ë„**: `[Confirmed]` â€” ë‹¤ìˆ˜ ë²¤ì¹˜ë§ˆí¬ ë° ê³µì‹ ë¬¸ì„œì—ì„œ ì¼ê´€ë˜ê²Œ í™•ì¸

---

## 6. ì°¨ì´ì  ë¹„êµ

```
                    HNSW                         IVF-PQ
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  ì•Œê³ ë¦¬ì¦˜    â”‚  ê·¸ë˜í”„ íƒìƒ‰   â”‚            â”‚ í´ëŸ¬ìŠ¤í„° + ì••ì¶•    â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                           â”‚
  ìë£Œ êµ¬ì¡°   â”‚  ë‹¤ì¸µ ê·¼ì ‘ ê·¸ë˜í”„ â”‚         â”‚ ì—­ì¸ë±ìŠ¤ + ì½”ë“œë¶  â”‚
                     â”‚                           â”‚
  ê²€ìƒ‰ ë°©ì‹   â”‚  Greedy traversalâ”‚         â”‚ Cluster pruning   â”‚
              â”‚  (topâ†’bottom)   â”‚         â”‚ + LUT lookup      â”‚
                     â”‚                           â”‚
  ë©”ëª¨ë¦¬      â”‚    ğŸ”´ ë†’ìŒ      â”‚         â”‚    ğŸŸ¢ ë§¤ìš° ë‚®ìŒ    â”‚
              â”‚  (1.3-2Ã— raw)  â”‚         â”‚   (~1% raw)       â”‚
                     â”‚                           â”‚
  Recall      â”‚    ğŸŸ¢ ë†’ìŒ      â”‚         â”‚    ğŸŸ¡ ì¤‘ê°„         â”‚
              â”‚   (95%+ ì‰¬ì›€)  â”‚         â”‚  (lossy ì••ì¶•)     â”‚
                     â”‚                           â”‚
  ê·œëª¨        â”‚   ìˆ˜ì–µ ë²¡í„°    â”‚          â”‚   ìˆ˜ì‹­ì–µ ë²¡í„°     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š ì •ëŸ‰ ë¹„êµí‘œ

| ê¸°ì¤€ | HNSW | IVF-PQ | ë¹„ê³  |
|------|------|--------|------|
| **ë©”ëª¨ë¦¬ (1B Ã— 768-d)** | ~3 TB | ~8 GB | ğŸ”¥ **375ë°° ì°¨ì´** |
| **Recall@10** | 95-99% | 70-85% | HNSW ì›”ë“± |
| **ê²€ìƒ‰ ì†ë„** | ~0.1-1ms | ~0.03-0.5ms | ê·œëª¨ì— ë”°ë¼ ë‹¤ë¦„ |
| **ë¹Œë“œ ì‹œê°„** | ëŠë¦¼ | ì¤‘ê°„ (í•™ìŠµ í¬í•¨) | IVF-Flatë³´ë‹¤ 2-5Ã— ëŠë¦¼ |
| **ë™ì  ì—…ë°ì´íŠ¸** | âœ… ìš°ìˆ˜ | âš ï¸ ì¬í•™ìŠµ í•„ìš” | HNSW ìš°ìœ„ |
| **GPU ê°€ì†** | ì œí•œì  | âœ… ìµœì í™” (cuVS) | IVF-PQ ìš°ìœ„ |
| **í•™ìŠµ ë‹¨ê³„** | ë¶ˆí•„ìš” | í•„ìˆ˜ (k-means + PQ) | HNSW ê°„í¸ |
| **íŒŒë¼ë¯¸í„° ìˆ˜** | 3ê°œ | 4-5ê°œ | IVF-PQ ë” ë³µì¡ |

> **í™•ì‹ ë„**: ë©”ëª¨ë¦¬ ìˆ˜ì¹˜ `[Confirmed]`, ì„±ëŠ¥ ìˆ˜ì¹˜ `[Likely]` (í™˜ê²½ ì˜ì¡´ì )

---

## 7. ì‚¬ìš© ì‹œ ì£¼ì˜ì 

### âš ï¸ HNSW ì£¼ì˜ì‚¬í•­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ HNSW í•¨ì • (Pitfalls)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  1. M ê°’ì„ ë¬´ì‘ì • ì˜¬ë¦¬ì§€ ë§ ê²ƒ                           â”‚
â”‚     â†’ M=16ì´ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì¶©ë¶„                         â”‚
â”‚     â†’ M=64 ì´ìƒ: ë©”ëª¨ë¦¬ í­ì¦, ì‚½ì… ì†ë„ ê¸‰ê°             â”‚
â”‚                                                          â”‚
â”‚  2. efConstruction â‰¥ efSearch ìœ ì§€                       â”‚
â”‚     â†’ ë¹Œë“œ í’ˆì§ˆì´ ë‚®ìœ¼ë©´ ê²€ìƒ‰ ì‹œ recall íšŒë³µ ë¶ˆê°€        â”‚
â”‚                                                          â”‚
â”‚  3. ì‚­ì œ(delete) ì²˜ë¦¬ ì£¼ì˜                              â”‚
â”‚     â†’ ë¬¼ë¦¬ì  ì‚­ì œê°€ ì•„ë‹Œ ë§ˆí‚¹ ë°©ì‹ â†’ ê·¸ë˜í”„ í’ˆì§ˆ ì €í•˜    â”‚
â”‚     â†’ ì‚­ì œ ë¹„ìœ¨ ë†’ì•„ì§€ë©´ ë¦¬ì¸ë±ì‹± í•„ìš”                   â”‚
â”‚                                                          â”‚
â”‚  4. ë©”ëª¨ë¦¬ ì‚¬ì „ ê³„ì‚° í•„ìˆ˜                                â”‚
â”‚     â†’ ê³µì‹: (4 Ã— d + 8 Ã— M) Ã— N bytes (ëŒ€ëµ)           â”‚
â”‚     â†’ 1ì–µ Ã— 768-d Ã— M=16 â‰ˆ ~150GB RAM                  â”‚
â”‚                                                          â”‚
â”‚  5. ì´ˆê¸° ë°ì´í„° ì ì„ ë•Œ ê·¸ë˜í”„ í’ˆì§ˆ ë‚®ìŒ                  â”‚
â”‚     â†’ ìˆ˜ì²œ ê°œ ì´í•˜ì—ì„œëŠ” brute-forceê°€ ë” ë‚˜ì„ ìˆ˜ ìˆìŒ   â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### âš ï¸ IVF-PQ ì£¼ì˜ì‚¬í•­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ IVF-PQ í•¨ì • (Pitfalls)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  1. í•™ìŠµ ë°ì´í„° ì¶©ë¶„íˆ í™•ë³´                              â”‚
â”‚     â†’ k-means + PQ ì½”ë“œë¶ í•™ìŠµì— ìµœì†Œ nlist Ã— 40ê°œ ë²¡í„°  â”‚
â”‚     â†’ í•™ìŠµ ë°ì´í„°ê°€ ë¶€ì¡±í•˜ë©´ í´ëŸ¬ìŠ¤í„° í’ˆì§ˆ ê¸‰ë½           â”‚
â”‚                                                          â”‚
â”‚  2. nprobe íŠœë‹ì´ í•µì‹¬                                   â”‚
â”‚     â†’ nprobe=1: ë¹ ë¥´ì§€ë§Œ recall ë§¤ìš° ë‚®ìŒ               â”‚
â”‚     â†’ nprobe=nlist: brute-forceì™€ ë™ì¼ â†’ ì˜ë¯¸ ì—†ìŒ      â”‚
â”‚     â†’ ê¶Œì¥: nlistì˜ 5-10% â†’ recall-latency ê³¡ì„  í™•ì¸     â”‚
â”‚                                                          â”‚
â”‚  3. ì„œë¸Œë²¡í„° ìˆ˜(m)ì™€ ì°¨ì›ì˜ ê´€ê³„                         â”‚
â”‚     â†’ dim % m == 0 ì´ì–´ì•¼ í•¨                            â”‚
â”‚     â†’ mì´ ë„ˆë¬´ ì‘ìœ¼ë©´ ì••ì¶• ì†ì‹¤ ê³¼ë‹¤                     â”‚
â”‚     â†’ mì´ ë„ˆë¬´ í¬ë©´ ë©”ëª¨ë¦¬ ì´ì  ê°ì†Œ                     â”‚
â”‚                                                          â”‚
â”‚  4. ë™ì  ë°ì´í„°ì— ë¶€ì í•©                                 â”‚
â”‚     â†’ ë°ì´í„° ë¶„í¬ ë³€ê²½ ì‹œ í´ëŸ¬ìŠ¤í„° ì¬í•™ìŠµ í•„ìš”            â”‚
â”‚     â†’ ì „ì²´ ë°ì´í„°ì˜ 10-20% ì´ìƒ ë³€ê²½ë˜ë©´ ë¦¬ì¸ë±ì‹± ê¶Œì¥   â”‚
â”‚                                                          â”‚
â”‚  5. Refinement ë‹¨ê³„ ê³ ë ¤                                 â”‚
â”‚     â†’ PQë§Œìœ¼ë¡œ ë¶€ì¡±í•œ recall â†’ ì›ë³¸ ë²¡í„°ë¡œ reranking     â”‚
â”‚     â†’ CPU ë©”ëª¨ë¦¬ì— ì›ë³¸ ë²¡í„° ë³„ë„ ì €ì¥ í•„ìš”              â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **í™•ì‹ ë„**: `[Confirmed]` â€” ê³µì‹ ë¬¸ì„œ ê¶Œì¥ì‚¬í•­ ë° ë‹¤ìˆ˜ ê¸°ìˆ  ë¸”ë¡œê·¸ì—ì„œ ì¼ì¹˜

---

## 8. ê¸°íƒ€ ê°œë°œìë¡œì„œ ì•Œì•„ë‘¬ì•¼ í•  ê²ƒë“¤

### ğŸ”€ í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ë²•: ë‘˜ ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  í•˜ì´ë¸Œë¦¬ë“œ ì¸ë±ìŠ¤ ì „ëµ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸ“Œ HNSW + PQ (Qdrant, Weaviate ê¸°ë³¸)                       â”‚
â”‚     â†’ HNSW ê·¸ë˜í”„ + PQ ì••ì¶• ë²¡í„°                            â”‚
â”‚     â†’ ë©”ëª¨ë¦¬ ì ˆê° + ë†’ì€ recall ìœ ì§€                         â”‚
â”‚                                                              â”‚
â”‚  ğŸ“Œ IVF + HNSW (FAISS)                                      â”‚
â”‚     â†’ IVFì˜ coarse quantizerë¥¼ HNSWë¡œ ëŒ€ì²´                  â”‚
â”‚     â†’ í´ëŸ¬ìŠ¤í„° íƒìƒ‰ ì†ë„ í–¥ìƒ                                â”‚
â”‚     â†’ FAISS ë²¤ì¹˜ë§ˆí¬: 0.03ms/query, recall 0.77             â”‚
â”‚                                                              â”‚
â”‚  ğŸ“Œ ScaNN (Google)                                           â”‚
â”‚     â†’ Recall@1ì—ì„œ HNSW/IVF-PQ ëŒ€ë¹„ ~2Ã— ë†’ì€ recall        â”‚
â”‚     â†’ ë¹„ëŒ€ì¹­ ì–‘ìí™” ê¸°ë°˜                                     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ§­ ì¸ë±ìŠ¤ ì„ íƒ ì˜ì‚¬ê²°ì • íŠ¸ë¦¬

```
                    ë²¡í„° ìˆ˜ëŠ”?
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚          â”‚          â”‚
         < 10K      10K~500M    > 500M
            â”‚          â”‚          â”‚
         Flat       ë©”ëª¨ë¦¬ëŠ”?     IVF-PQ
        (brute)        â”‚          (ë˜ëŠ” HNSW+PQ)
                  â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
                  â”‚         â”‚
               ì¶©ë¶„       ë¶€ì¡±
                  â”‚         â”‚
               HNSW      HNSW+PQ
                          ë˜ëŠ”
                         IVF-PQ
                           â”‚
                     ì—…ë°ì´íŠ¸ ë¹ˆë„?
                    â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
                  ë¹ˆë²ˆ          ë“œë­„
                    â”‚             â”‚
                 HNSW+PQ       IVF-PQ
```

### ğŸ“š ì•Œì•„ë‘ë©´ ì¢‹ì€ ì¶”ê°€ ê°œë…

| ê°œë… | ì„¤ëª… |
|------|------|
| **OPQ** (Optimized PQ) | PQ ì „ì— íšŒì „ ë³€í™˜ ì ìš© â†’ ì„œë¸Œë²¡í„° ê°„ ìƒê´€ê´€ê³„ ì œê±° â†’ recall í–¥ìƒ |
| **Refinement/Reranking** | PQ 1ì°¨ ê²€ìƒ‰ í›„ ì›ë³¸ ë²¡í„°ë¡œ ì¬ì •ë ¬ â†’ recall íšŒë³µ |
| **DiskANN** (Microsoft) | SSD ê¸°ë°˜ ANN â†’ ë©”ëª¨ë¦¬ì— ì•ˆ ì˜¬ë¼ê°€ëŠ” ë°ì´í„°ë„ ì²˜ë¦¬ ê°€ëŠ¥ |
| **RaBitQ** | ìµœê·¼ ì£¼ëª©ë°›ëŠ” 1-bit ì–‘ìí™” â†’ IVF-Flat ìˆ˜ì¤€ recallì— 32Ã— ì••ì¶• |
| **ê±°ë¦¬ ë©”íŠ¸ë¦­** | cosine similarity, L2 (euclidean), inner product â€” ì¸ë±ìŠ¤ ìƒì„± ì „ ê²°ì • í•„ìˆ˜ |
| **ì •ê·œí™”** | cosine similarity ì‚¬ìš© ì‹œ ë²¡í„°ë¥¼ ë¯¸ë¦¬ L2 ì •ê·œí™”í•˜ë©´ inner productë¡œ ëŒ€ì²´ ê°€ëŠ¥ |

### ğŸ”„ í”„ë¡œë•ì…˜ RAGì—ì„œ HNSW â†’ IVF-PQ ì „í™˜ì˜ ì˜ë¯¸

```
í˜„ì¬ ìƒíƒœ:  HNSW (ë†’ì€ recall, ë†’ì€ ë©”ëª¨ë¦¬)
    â”‚
    â–¼  Scale Up ìµœì í™”
    â”‚
ì „í™˜ í›„:   IVF-PQ (ì ì ˆí•œ recall, ê·¹ì  ë©”ëª¨ë¦¬ ì ˆê°)
    â”‚
    â”œâ”€ ê²€ìƒ‰ ë²”ìœ„: ì „ì²´ ê·¸ë˜í”„ â†’ nprobeê°œ í´ëŸ¬ìŠ¤í„°ë¡œ ì¶•ì†Œ
    â”œâ”€ ë©”ëª¨ë¦¬: ~2Ã— raw â†’ ~1% raw (100ë°°+ ì ˆê°)
    â””â”€ ë™ì¼ í•˜ë“œì›¨ì–´ì—ì„œ ë” ë§ì€ ë°ì´í„° ì²˜ë¦¬ ê°€ëŠ¥
```

ì´ ì „í™˜ì€ **ë°ì´í„°ê°€ ì¶©ë¶„íˆ ì»¤ì ¸ì„œ HNSWê°€ ë©”ëª¨ë¦¬ì— ì•ˆ ì˜¬ë¼ê°€ê±°ë‚˜**, **ë‹¨ì¼ ë…¸ë“œ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”**í•´ì•¼ í•  ë•Œì˜ Scale Up ì „ëµì´ë‹¤.

---

## 9. Sources

1. [HNSW ì›ë…¼ë¬¸ (Malkov & Yashunin, 2016)](https://arxiv.org/abs/1603.09320) â€” ì›ë…¼ë¬¸
2. [Pinecone HNSW ê°€ì´ë“œ](https://www.pinecone.io/learn/series/faiss/hnsw/) â€” ê¸°ìˆ  êµìœ¡ ìë£Œ
3. [Milvus: How to Choose Between IVF and HNSW](https://milvus.io/blog/understanding-ivf-vector-index-how-It-works-and-when-to-choose-it-over-hnsw.md) â€” ê³µì‹ ë¸”ë¡œê·¸
4. [NVIDIA cuVS IVF-PQ Deep Dive](https://developer.nvidia.com/blog/accelerating-vector-search-nvidia-cuvs-ivf-pq-deep-dive-part-1/) â€” ê³µì‹ ê¸°ìˆ  ë¸”ë¡œê·¸
5. [Milvus IVF-PQ Documentation](https://milvus.io/docs/ivf-pq.md) â€” ê³µì‹ ë¬¸ì„œ
6. [Pinecone Product Quantization ê°€ì´ë“œ](https://www.pinecone.io/learn/series/faiss/product-quantization/) â€” ê¸°ìˆ  êµìœ¡ ìë£Œ
7. [Wikipedia: HNSW](https://en.wikipedia.org/wiki/Hierarchical_navigable_small_world) â€” ë°±ê³¼ì‚¬ì „
8. [MyScale: HNSW vs IVF Comparison](https://www.myscale.com/blog/hnsw-vs-ivf-explained-powerful-comparison/) â€” ê¸°ìˆ  ë¸”ë¡œê·¸
9. [TiDB: ANN Search Explained (IVF vs HNSW vs PQ)](https://www.pingcap.com/article/approximate-nearest-neighbor-ann-search-explained-ivf-vs-hnsw-vs-pq/) â€” ê¸°ìˆ  ë¸”ë¡œê·¸
10. [AWS: k-NN Algorithm for Billion-Scale](https://aws.amazon.com/blogs/big-data/choose-the-k-nn-algorithm-for-your-billion-scale-use-case-with-opensearch/) â€” ê³µì‹ ë¸”ë¡œê·¸
11. [Zilliz: Understanding HNSW](https://zilliz.com/learn/hierarchical-navigable-small-worlds-HNSW) â€” ê¸°ìˆ  êµìœ¡ ìë£Œ
12. [IVFPQ+HNSW for Billion-scale Search (TDS)](https://towardsdatascience.com/ivfpq-hnsw-for-billion-scale-similarity-search-89ff2f89d90e/) â€” ê¸°ìˆ  ë¸”ë¡œê·¸

---

## Research Metadata

| í•­ëª© | ê°’ |
|------|-----|
| ê²€ìƒ‰ ì¿¼ë¦¬ ìˆ˜ | 7 (ì¼ë°˜ 5 + SNS 1 + ì‹¬í™” 2) |
| ìˆ˜ì§‘ ì¶œì²˜ ìˆ˜ | 15+ |
| ì¶œì²˜ ìœ í˜• ë¶„í¬ | ê³µì‹ ë¬¸ì„œ 4, ì›ë…¼ë¬¸ 2, ê¸°ìˆ  ë¸”ë¡œê·¸ 6, ì»¤ë®¤ë‹ˆí‹° 2 |
| í™•ì‹ ë„ ë¶„í¬ | Confirmed 5, Likely 3, Uncertain 0, Unverified 0 |
